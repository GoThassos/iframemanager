/*!
 * iframemanager v1.1.0
 * Author Orest Bida
 * Released under the MIT License
 */
(()=>{'use strict';const e='click',t='{data-id}',n='ACCEPT',o='REJECT';let c,i,s,r,a,l={},f=!1,d='',u={},m=new Map,v='api';const h=['onload','onerror','src'],p=e=>'function'==typeof e,b=e=>'string'==typeof e,w=e=>i.createElement(e),_=()=>w('div'),g=()=>{const e=w('button');return e.type='button',e},$=(e,t)=>e.className=t,S=(e,t)=>e.appendChild(t),T=e=>e&&Object.keys(e)||[],E=(e,t)=>{for(const n in t)P(e,n,t[n])},I=e=>{const t=e.dataset,n={},o='data-iframe-',c=e.getAttributeNames().filter((e=>e.slice(0,12)===o)).map((e=>e.slice(12))),i=e.querySelector('[data-placeholder]');i&&i.removeAttribute('data-visible');const s=i&&i.cloneNode(!0);for(const t of c)n[t]=e.getAttribute(o+t);return{t:t.id,o:t.title,i:t.thumbnail,l:t.params,u:e,m:null,v:i,h:s,p:null,_:!1,g:!1,$:!0,S:n}},x=(e,t)=>{const n=l[e];if('IntersectionObserver'in c){const e=new IntersectionObserver((o=>{o.forEach((o=>{o.isIntersecting&&(y(t,n[o.target.dataset.index]),e.unobserve(o.target))}))}));for(const t of n)e.observe(t.u)}},y=(e,n)=>{const o=e=>{n.p.style.backgroundImage=`url('${e}')`;const t=new Image;t.onload=()=>{n.p.classList.add('loaded')},t.src=e};if(b(n.i))''!==n.i&&o(n.i);else if(p(e))e(n.t,(e=>o(e)));else if(b(e)){const c=e.replace(t,n.t);o(c)}},C=(e,n)=>{if(e._)return;if(e._=!0,e.v){const t=e.h.cloneNode(!0);e.v.replaceWith(t),e.v=t}const o=n.iframe;if(p(n.onAccept))return void n.onAccept(e.u,(t=>{if(!(t instanceof HTMLIFrameElement))return!1;E(t,o),E(t,e.S),e.T=t,e._=!0,e.u.classList.add('c-h-b')}));e.T=w('iframe');const c=e.l||n.iframe&&n.iframe.params;let i=(n.embedUrl||'').replace(t,e.t);e.o&&(e.T.title=e.o),c&&('ap:'===c.substring(0,3)?i+=c.substring(3):i+='?'+c),e.T.onload=()=>{e.u.classList.add('c-h-b'),e.T.onload=void 0,o&&p(o.onload)&&o.onload(e.t,e.T)},E(e.T,o),E(e.T,e.S),e.T.src=i,S(e.m,e.T)},P=(e,t,n)=>{h.includes(t)||e.setAttribute(t,n)},k=e=>{e.u.classList.add('c-h-n'),e.$=!1},D=e=>{e.u.classList.remove('c-h-n','c-h-b'),e.$=!0},O=e=>(e=i.cookie.match(`(^|;)\\s*${e}\\s*=\\s*([^;]+)`))?e.pop():'',M=(t,n,o)=>{const c=l[t],s=n.languages;c.forEach((c=>{if(!c.g&&s){const r=s[d]?.loadBtn,a=s[d]?.notice,l=s[d]?.loadAllBtn,f=i.createElement('div'),u=_(),m=_(),h=_(),p=_();$(f,'cll'),c.m=f;const T=()=>{k(c),C(c,n)};if(r){const t=g();t.textContent=r,$(t,'c-l-b'),t.addEventListener(e,T),S(p,t)}if(l){const n=g();n.textContent=l,$(n,'c-la-b'),n.addEventListener(e,(()=>{T(),v=e,F.acceptService(t)})),S(p,n)}const E=_(),I=_(),x=_(),y=_(),P=_();$(E,'cc-text'),$(y,'c-bg-i'),c.p=y,$(x,'c-ld'),b(c.i)&&''===c.i||$(I,'c-bg');const D=c.o,O=i.createDocumentFragment();if(D){const e=w('span');$(e,'c-tl'),e.insertAdjacentHTML('beforeend',D),S(O,e)}S(E,O),u&&E.insertAdjacentHTML('beforeend',a||''),S(m,E),$(P,'c-t-cn'),$(m,'c-n-t'),$(h,'c-n-c'),$(u,'c-nt'),$(p,'c-n-a'),S(P,m),(r||l)&&S(P,p),S(h,P),S(u,h),S(I,y),S(f,u),(n.thumbnailUrl||c.i)&&S(f,I),S(f,x),o&&c.u.classList.add('c-h-n'),c.u.prepend(f),c.g=!0,setTimeout((()=>c.u.classList.add('c-an')),20)}}))},j=(e,t)=>{const n=l[e];if('IntersectionObserver'in c){const e=new IntersectionObserver((o=>{if(f)e.disconnect();else for(let c=0;c<o.length;++c)o[c].isIntersecting&&(c=>{const i=o[c].target;setTimeout((()=>{const e=i.dataset.index;C(n[e],t),k(n[e])}),50*c),e.unobserve(i)})(c)}));n.forEach((t=>{t._||e.observe(t.u)}))}},A=(e,t)=>e in t?e:T(t).length>0?d in t?d:T(t)[0]:void 0,J=(e,t)=>{const{cookie:n}=t;O(n.name)||(e=>{const{hostname:t,protocol:n}=location,o=e.name,c=new Date,s=e.path||'/',r=864e5*(e.expiration||182),a=e.sameSite||'Lax',l=e.domain||t;c.setTime(c.getTime()+r);let f=o+'=1'+(0!==r?`; Expires=${c.toUTCString()}`:'')+`; Path=${s}`+`; SameSite=${a}`;l.indexOf('.')>-1&&(f+=`; Domain=${l}`),'https:'===n&&(f+='; Secure'),i.cookie=f})(n),j(e,t)},L=(e,t)=>{const{cookie:n}=t;O(n.name)&&(e=>{const t=e.name,n=e.path||'/',o=e.domain||location.hostname;i.cookie=`${t}=; Path=${n}; Domain=${o}; Expires=Thu, 01 Jan 1970 00:00:01 GMT;`})(n),((e,t)=>{const n=l[e];for(let e=0;e<n.length;e++)(e=>{var o;n[e]._&&(p(t.onReject)?(t.onReject(n[e].T),n[e]._=!1):((o=n[e]).T.parentNode.removeChild(o.T),o._=!1)),D(n[e])})(e)})(e,t)},N=(e,t,n)=>{p(a)&&a({eventSource:{type:v,service:e,action:t},changedServices:n})},F={acceptService:e=>{f=!1;const t=[];if('all'===e){for(const e of r)m.get(e)||(m.set(e,!0),J(e,u[e]),t.push(e));t.length>0&&N(e,n,t)}else r.includes(e)&&(m.get(e)||(m.set(e,!0),J(e,u[e]),t.push(e),N(e,n,t)));v='api'},rejectService:e=>{const t=[];if('all'===e){f=!0;for(const e of r)L(e,u[e]),m.get(e)&&(m.set(e,!1),t.push(e));t.length>0&&N(e,o,t)}else r.includes(e)&&(L(e,u[e]),m.get(e)&&(m.set(e,!1),t.push(e),N(e,o,t)))},childExists:async({parent:e=c,childProperty:t,childSelector:n='iframe',timeout:o=1e3,maxTimeout:i=15e3})=>{let s=1;const r=t?()=>e[t]:()=>e.querySelector(n);return new Promise((e=>{const t=()=>{if(r()||s++*o>i)return e(void 0!==r());setTimeout(t,o)};t()}))},getState:()=>({services:new Map(m),acceptedServices:[...m].filter((([e,t])=>!!t)).map((([e])=>e))}),getConfig:()=>s,run:e=>{if(i=document,c=window,s=e,u=s.services,a=s.onChange,r=T(u),0===r.length)return;d=s.currLang;const t=u[r[0]].languages;!0===s.autoLang?d=A(navigator.language.slice(0,2).toLowerCase(),t):b(s.currLang)&&(d=A(s.currLang,t));for(const e of r){l[e]=[];const t=i.querySelectorAll(`div[data-service="${e}"]`),n=t.length;if(0===n)continue;for(let o=0;o<n;o++)t[o].dataset.index=o,l[e].push(I(t[o]));const o=u[e],{cookie:c}=o;!c&&(o.cookie={});const s=o.cookie,r=s.name||`im_${e}`;s.name=r;const a=O(r);m.set(e,!!a),a?(M(e,o,!0),j(e,o)):M(e,o,!1),x(e,o.thumbnailUrl)}}},G='iframemanager';'undefined'==typeof window||p(window[G])||(window[G]=()=>F)})();