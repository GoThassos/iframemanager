/*!
 * iframemanager v1.1.0
 * Author Orest Bida
 * Released under the MIT License
 */
(()=>{'use strict';const e='click',t='{data-id}',n='accept',o='reject';let c,i,s,r,a,l={},f=!1,d='',u={},m=new Map,v='api';const h=['onload','onerror','src'],p=e=>'function'==typeof e,b=e=>'string'==typeof e,w=e=>i.createElement(e),_=()=>w('div'),g=()=>{const e=w('button');return e.type='button',e},$=(e,t)=>e.className=t,S=(e,t)=>e.appendChild(t),I=e=>e&&Object.keys(e)||[],T=(e,t)=>{for(const n in t)O(e,n,t[n])},x=e=>{const t=e.dataset,n={},o='data-iframe-',c=e.getAttributeNames().filter((e=>e.slice(0,12)===o)).map((e=>e.slice(12))),i=e.querySelector('[data-placeholder]');i&&i.removeAttribute('data-visible');const s=i&&i.cloneNode(!0);for(const t of c)n[t]=e.getAttribute(o+t);return{t:t.id,o:t.title,i:t.thumbnail,l:t.params,u:e,m:null,v:i,h:s,p:null,_:!1,g:!1,$:!0,S:n}},y=(e,t)=>{const n=l[e];if('IntersectionObserver'in c){const e=new IntersectionObserver((o=>{o.forEach((o=>{o.isIntersecting&&(k(t,n[o.target.dataset.index]),e.unobserve(o.target))}))}));for(const t of n)e.observe(t.u)}},k=(e,n)=>{const o=e=>{n.p.style.backgroundImage=`url('${e}')`;const t=new Image;t.onload=()=>{n.p.classList.add('loaded')},t.src=e};if(b(n.i))''!==n.i&&o(n.i);else if(p(e))e(n.t,(e=>o(e)));else if(b(e)){const c=e.replace(t,n.t);o(c)}},D=(e,n)=>{if(e._)return;if(e._=!0,e.v){const t=e.h.cloneNode(!0);e.v.replaceWith(t),e.v=t}const o=n.iframe;if(p(n.onAccept))return void n.onAccept(e.u,(t=>{if(!(t instanceof HTMLIFrameElement))return!1;T(t,o),T(t,e.S),e.I=t,e._=!0,e.u.classList.add('c-h-b')}));e.I=w('iframe');const c=e.l||n.iframe&&n.iframe.params;let i=(n.embedUrl||'').replace(t,e.t);e.o&&(e.I.title=e.o),c&&('ap:'===c.substring(0,3)?i+=c.substring(3):i+='?'+c),e.I.onload=()=>{e.u.classList.add('c-h-b'),e.I.onload=void 0,o&&p(o.onload)&&o.onload(e.t,e.I)},T(e.I,o),T(e.I,e.S),e.I.src=i,S(e.m,e.I)},O=(e,t,n)=>{h.includes(t)||e.setAttribute(t,n)},P=e=>{e.u.classList.add('c-h-n'),e.$=!1},E=e=>{e.u.classList.remove('c-h-n','c-h-b'),e.$=!0},M=e=>(e=i.cookie.match(`(^|;)\\s*${e}\\s*=\\s*([^;]+)`))?e.pop():'',j=(t,n,o)=>{const c=l[t],s=n.languages;c.forEach((c=>{if(!c.g&&s){const r=s[d]?.loadBtn,a=s[d]?.notice,l=s[d]?.loadAllBtn,f=i.createElement('div'),u=_(),m=_(),h=_(),p=_();$(f,'cll'),c.m=f;const I=()=>{P(c),D(c,n)};if(r){const t=g();t.textContent=r,$(t,'c-l-b'),t.addEventListener(e,I),S(p,t)}if(l){const n=g();n.textContent=l,$(n,'c-la-b'),n.addEventListener(e,(()=>{I(),v=e,G.acceptService(t)})),S(p,n)}const T=_(),x=_(),y=_(),k=_(),O=_();$(T,'cc-text'),$(k,'c-bg-i'),c.p=k,$(y,'c-ld'),b(c.i)&&''===c.i||$(x,'c-bg');const E=c.o,M=i.createDocumentFragment();if(E){const e=w('span');$(e,'c-tl'),e.insertAdjacentHTML('beforeend',E),S(M,e)}S(T,M),u&&T.insertAdjacentHTML('beforeend',a||''),S(m,T),$(O,'c-t-cn'),$(m,'c-n-t'),$(h,'c-n-c'),$(u,'c-nt'),$(p,'c-n-a'),S(O,m),(r||l)&&S(O,p),S(h,O),S(u,h),S(x,k),S(f,u),(n.thumbnailUrl||c.i)&&S(f,x),S(f,y),o&&c.u.classList.add('c-h-n'),c.u.prepend(f),c.g=!0,setTimeout((()=>c.u.classList.add('c-an')),20)}}))},C=(e,t)=>{const n=l[e];if('IntersectionObserver'in c){const e=new IntersectionObserver((o=>{if(f)e.disconnect();else for(let c=0;c<o.length;++c)o[c].isIntersecting&&(c=>{const i=o[c].target;setTimeout((()=>{const e=i.dataset.index;D(n[e],t),P(n[e])}),50*c),e.unobserve(i)})(c)}));n.forEach((t=>{t._||e.observe(t.u)}))}},L=(e,t)=>e in t?e:I(t).length>0?d in t?d:I(t)[0]:void 0,N=(e,t)=>{const{cookie:n}=t;M(n.name)||(e=>{const{hostname:t,protocol:n}=location,o=e.name,c=new Date,s=e.path||'/',r=864e5*(e.expiration||182),a=e.sameSite||'Lax',l=e.domain||t;c.setTime(c.getTime()+r);let f=o+'=1'+(0!==r?`; Expires=${c.toUTCString()}`:'')+`; Path=${s}`+`; SameSite=${a}`;l.indexOf('.')>-1&&(f+=`; Domain=${l}`),'https:'===n&&(f+='; Secure'),i.cookie=f})(n),C(e,t)},A=(e,t)=>{const{cookie:n}=t;M(n.name)&&(e=>{const t=e.name,n=e.path||'/',o=e.domain||location.hostname;i.cookie=`${t}=; Path=${n}; Domain=${o}; Expires=Thu, 01 Jan 1970 00:00:01 GMT;`})(n),((e,t)=>{const n=l[e];for(let e=0;e<n.length;e++)(e=>{var o;n[e]._&&(p(t.onReject)?(t.onReject(n[e].I),n[e]._=!1):((o=n[e]).I.parentNode.removeChild(o.I),o._=!1)),E(n[e])})(e)})(e,t)},F=(e,t,n)=>{p(a)&&a({eventSource:{type:v,service:e,action:t},changedServices:n})},G={acceptService:e=>{f=!1;const t=[];if('all'===e){for(const e of r)m.get(e)||(m.set(e,!0),N(e,u[e]),t.push(e));t.length>0&&F(e,n,t)}else r.includes(e)&&(m.get(e)||(m.set(e,!0),N(e,u[e]),t.push(e),F(e,n,t)));v='api'},rejectService:e=>{const t=[];if('all'===e){f=!0;for(const e of r)A(e,u[e]),m.get(e)&&(m.set(e,!1),t.push(e));t.length>0&&F(e,o,t)}else r.includes(e)&&(A(e,u[e]),m.get(e)&&(m.set(e,!1),t.push(e),F(e,o,t)))},childExists:async({parent:e=c,childProperty:t,childSelector:n='iframe',timeout:o=1e3,maxTimeout:i=15e3})=>{let s=1;const r=t?()=>e[t]:()=>e.querySelector(n);return new Promise((e=>{const t=()=>{if(r()||s++*o>i)return e(void 0!==r());setTimeout(t,o)};t()}))},getState:()=>({services:new Map(m),acceptedServices:[...m].filter((([e,t])=>!!t)).map((([e])=>e))}),getConfig:()=>s,run:e=>{if(i=document,c=window,s=e,u=s.services,a=s.onChange,r=I(u),0===r.length)return;d=s.currLang;const t=u[r[0]].languages;!0===s.autoLang?d=L(navigator.language.slice(0,2).toLowerCase(),t):b(s.currLang)&&(d=L(s.currLang,t));for(const e of r){l[e]=[];const t=i.querySelectorAll(`div[data-service="${e}"]`),n=t.length;if(0===n)continue;for(let o=0;o<n;o++)t[o].dataset.index=o,l[e].push(x(t[o]));const o=u[e],{cookie:c}=o;!c&&(o.cookie={});const s=o.cookie,r=s.name||`im_${e}`;s.name=r;const a=M(r);m.set(e,!!a),a?(j(e,o,!0),C(e,o)):j(e,o,!1),y(e,o.thumbnailUrl)}}},H='iframemanager';'undefined'==typeof window||p(window[H])||(window[H]=()=>G)})();